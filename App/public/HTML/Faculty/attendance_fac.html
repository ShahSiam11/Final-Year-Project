<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/imagess/attendeaselogo.png">
  <title>Faculty Portal</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@48,400,0,0" />
  <link rel="stylesheet" href="/CSS/Faculty/attendance_fac.css">
</head>
<body>
   <div class="container">
    <aside>
      <div class="top">
        <h2 class="logo1"> AttendEase </h2>
        <div class="close" id="close_btn">
          <span class="material-symbols-sharp">close</span>
        </div>
      </div>
      <div class="sidebar">
        <a href="/Faculty_Dashboard" class="nav-link"><lord-icon src="https://cdn.lordicon.com/cnpvyndp.json" colors="primary:#D455E6"class="icon"></lord-icon><h3>Faculty Dashboard</h3></a>
        <a href="/Attendance_fac" class="active"><lord-icon src="https://cdn.lordicon.com/jkzgajyr.json" colors="primary:#D455E6"class="icon"></lord-icon><h3>Attendance</h3></a>
        <a href="/Faculty_Analysis" class="nav-link"><lord-icon src="https://cdn.lordicon.com/pqirzoux.json" colors="primary:#D455E6"class="icon"></lord-icon><h3>Faculty Analysis</h3></a>
        <a href="/Management" class="nav-link"><lord-icon src="https://cdn.lordicon.com/pflszboa.json" colors="primary:#D455E6"class="icon"></lord-icon><h3>Management</h3><span class="msg_count">14</span></a>
        <a href="#" class="nav-link"><lord-icon src="https://cdn.lordicon.com/lecprnjb.json" colors="primary:#D455E6"class="icon"></lord-icon><h3>Settings</h3></a>
        <a href="/" class="nav-link"><lord-icon src="https://cdn.lordicon.com/nqtddedc.json" colors="primary:#D455E6"class="icon"></lord-icon><h3>Logout</h3></a>
      </div>
    </aside>

      <main>


    <main class="table_attend" id="customers_table">
        <section class="table__header">
            <div class="input-group">
                <input type="search" placeholder="Search Data...">
                <img src="/images/search.png" alt="">
            </div>

            </select>
            <div class="export__file">
                <label for="export-file" class="export__file-btn" title="Export File"><lord-icon
    src="https://cdn.lordicon.com/smwmetfi.json"
    trigger="hover"
    style="width:30px;height:30px">
</lord-icon></label>
                <input type="checkbox" id="export-file">
                <div class="export__file-options">
                    <label>Export As &nbsp; &#10140;</label>
                    <label for="export-file" id="toPDF">PDF <img src="/images/pdf.png" alt=""></label>
                    <label for="export-file" id="toJSON">JSON <img src="/images/json.png" alt=""></label>
                    <label for="export-file" id="toCSV">CSV <img src="/images/csv.png" alt=""></label>
                    <label for="export-file" id="toEXCEL">EXCEL <img src="/images/excel.png" alt=""></label>
                </div>
            </div>
        </section>
        <section class="table__body">
            <table id="Date__Table">
                <thead>
                    <tr>
                        <th> Date <span class="icon-arrow">&UpArrow;</span></th>
                        <th> Time Joined <span class="icon-arrow">&UpArrow;</span></th>
                        <th> Student ID <span class="icon-arrow">&UpArrow;</span></th>
                        <th> Name <span class="icon-arrow">&UpArrow;</span></th>
                        <th> Time Stayed <span class="icon-arrow">&UpArrow;</span></th>
                        <th> Label <span class="icon-arrow">&UpArrow;</span></th>
                        <th> Attendance <span class="icon-arrow">&UpArrow;</span></th>
                    </tr>
                </thead>
                <tbody>

                </tbody>
            </table>
        </section>
    </main>

      </main>

    <div class="right">

<div class="top">
   <button id="menu_bar">
     <span class="material-symbols-sharp">menu</span>
   </button>
 <div class="theme-toggler">
  <label class="switch">
    <!-- Using the same id ("input") so that your existing JS continues to work -->
    <input id="input" type="checkbox" />
    <div class="slider round">
      <div class="sun-moon">
        <!-- Moon dots and light rays (SVGs for the animated sun/moon) -->
        <svg id="moon-dot-1" class="moon-dot" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="50"></circle>
        </svg>
        <svg id="moon-dot-2" class="moon-dot" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="50"></circle>
        </svg>
        <svg id="moon-dot-3" class="moon-dot" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="50"></circle>
        </svg>
        <svg id="light-ray-1" class="light-ray" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="50"></circle>
        </svg>
        <svg id="light-ray-2" class="light-ray" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="50"></circle>
        </svg>
        <svg id="light-ray-3" class="light-ray" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="50"></circle>
        </svg>
        <!-- Clouds (two types to allow color variations) -->
        <svg id="cloud-1" class="cloud-dark" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="50"></circle>
        </svg>
        <svg id="cloud-2" class="cloud-dark" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="50"></circle>
        </svg>
        <svg id="cloud-3" class="cloud-dark" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="50"></circle>
        </svg>
        <svg id="cloud-4" class="cloud-light" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="50"></circle>
        </svg>
        <svg id="cloud-5" class="cloud-light" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="50"></circle>
        </svg>
        <svg id="cloud-6" class="cloud-light" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="50"></circle>
        </svg>
      </div>
      <div class="stars">
        <svg id="star-1" class="star" viewBox="0 0 20 20">
          <path d="M 0 10 C 10 10,10 10, 0 10 C 10 10, 10 10, 10 20 C 10 10, 10 10, 20 10 C 10 10, 10 10, 10 0 C 10 10,10 10, 0 10 Z"></path>
        </svg>
        <svg id="star-2" class="star" viewBox="0 0 20 20">
          <path d="M 0 10 C 10 10,10 10, 0 10 C 10 10, 10 10, 10 20 C 10 10, 10 10, 20 10 C 10 10, 10 10, 10 0 C 10 10,10 10, 0 10 Z"></path>
        </svg>
        <svg id="star-3" class="star" viewBox="0 0 20 20">
          <path d="M 0 10 C 10 10,10 10, 0 10 C 10 10, 10 10, 10 20 C 10 10, 10 10, 20 10 C 10 10, 10 10, 10 0 C 10 10,10 10, 0 10 Z"></path>
        </svg>
        <svg id="star-4" class="star" viewBox="0 0 20 20">
          <path d="M 0 10 C 10 10,10 10, 0 10 C 10 10, 10 10, 10 20 C 10 10, 10 10, 20 10 C 10 10, 10 10, 10 0 C 10 10,10 10, 0 10 Z"></path>
        </svg>
      </div>
    </div>
  </label>
</div>

    <div class="profile">
       <div class="info">
           <b><p id="name"></p></b>
           <p id="role"></p>
           <small class="text-muted"></small>
       </div>
       <!--<div class="profile-photo">
         <img src="./images/profile-1.jpg" alt=""/>
       </div>-->
    </div>
</div>


  <div class="recent_updates">
     <h2 id="viewByDateBtn">View Attendance Logs</h2>
   <div class="updates">
      <div>
         <div>
         </div>
        <div class="message">
<select id="logFileSelect">
    <option value="" disabled selected>Select Log</option>

</select>

        </div>
      </div>
      <div class="updat0e">

     </div>
     <div class="updat0e">

   </div>
  </div>
  </div>



</div>


   </div>

    <script>

        fetch('/log-files')
            .then(response => response.json())
            .then(data => {
                const logFileSelect = document.getElementById('logFileSelect');
                data.forEach(logFile => {
                    const option = document.createElement('option');
                    option.value = logFile;
                    option.textContent = logFile;
                    logFileSelect.appendChild(option);
                });

                if (data.length > 0) {
                    logFileSelect.value = data[data.length - 1]; // assuming the last one is the most recent
                    loadAttendanceData(data[data.length - 1]); // Load the most recent log file data
                }
            })
            .catch(error => {
                console.error('Error fetching log files:', error);
            });

        // Fetch attendance data for a specific log file
        function loadAttendanceData(logFile) {
            fetch(`/data/${logFile}`)
                .then(response => response.json())
                .then(data => {
                    const tableBody = document.querySelector('#Date__Table tbody');
                    tableBody.innerHTML = ''; // Clear existing rows

                    data.forEach(item => {
                        const row = document.createElement('tr');
                        const statusClass = item.Attendance === 'Marked' ? 'Marked' : 'NotMarked';
                        row.innerHTML = `
                            <td>${item.Date}</td>
                            <td>${item.Time}</td>
                            <td>${item.StudentID}</td>
                            <td>${item.Name}</td>
                            <td>${item.Duration}</td>
                            <td>${item.Label}</td>
                            <td><span class="status ${statusClass}">${item.Attendance}</span></td>
                        `;
                        tableBody.appendChild(row);
                    });
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
        }

        // Add event listener to the button to view attendance by date
        document.getElementById('viewByDateBtn').addEventListener('click', () => {
            const logFile = document.getElementById('logFileSelect').value;
            loadAttendanceData(logFile); // Load data for the selected log file
        });

        // Add event listener for the dropdown change to load new data
        document.getElementById('logFileSelect').addEventListener('change', (e) => {
            loadAttendanceData(e.target.value); // Load data for the selected log file
        });

        const burgerIcon = document.getElementById('burgerIcon');
        const menu = document.getElementById('menu');
        const overlay = document.getElementById('overlay');
        const backArrow = document.getElementById('backArrow');

        // Function to toggle menu visibility
        const toggleMenu = (open) => {
            menu.classList.toggle('menu-open', open);
            overlay.classList.toggle('overlay-active', open);
        };

        // Open menu when burger icon is clicked
        burgerIcon.addEventListener('click', () => toggleMenu(true));

        // Close menu when back arrow is clicked
        backArrow.addEventListener('click', () => toggleMenu(false));

        // Close menu when clicking outside
        overlay.addEventListener('click', () => toggleMenu(false));
    </script>

<script src="https://cdn.lordicon.com/lordicon.js"></script>
   <script src="/JavaScript/Faculty/attendance_fac.js"></script>
</body>
</html>